<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¤ì • ê°€ì´ë“œ - Splunk & FortiNet ì—°ë™</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0a0f1c 0%, #1a2332 100%);
            color: #fff;
            min-height: 100vh;
            line-height: 1.6;
        }
        .header {
            background: rgba(0,0,0,0.4);
            padding: 30px 20px;
            border-bottom: 3px solid #4CAF50;
            text-align: center;
        }
        .header h1 {
            font-size: 32px;
            font-weight: 300;
            margin-bottom: 10px;
            color: #4CAF50;
        }
        .header .subtitle {
            color: #bbb;
            font-size: 18px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .guide-section {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 40px;
            backdrop-filter: blur(15px);
        }
        .section-title {
            font-size: 28px;
            margin-bottom: 25px;
            color: #4CAF50;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .step-container {
            display: grid;
            gap: 30px;
            margin-top: 30px;
        }
        .step-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 30px;
            position: relative;
            transition: all 0.3s ease;
        }
        .step-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.1);
        }
        .step-number {
            position: absolute;
            top: -15px;
            left: 30px;
            background: #4CAF50;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
        }
        .step-title {
            font-size: 22px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 20px;
            margin-top: 10px;
        }
        .step-content {
            color: #ddd;
            margin-bottom: 20px;
        }
        .code-block {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            color: #e6edf3;
            overflow-x: auto;
            margin: 15px 0;
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #238636;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
        }
        .copy-btn:hover {
            background: #2ea043;
        }
        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #fff3cd;
        }
        .info-box {
            background: rgba(23, 162, 184, 0.1);
            border: 1px solid #17a2b8;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #d1ecf1;
        }
        .success-box {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #d4edda;
        }
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        .screenshot-placeholder {
            background: rgba(255,255,255,0.05);
            border: 2px dashed rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            color: #aaa;
            font-style: italic;
        }
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        .nav-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        .nav-btn.secondary {
            background: #6c757d;
        }
        .nav-btn.secondary:hover {
            background: #5a6268;
        }
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”§ Splunk & FortiNet ì—°ë™ ì„¤ì • ê°€ì´ë“œ</h1>
        <div class="subtitle">ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ì • ë°©ë²• - 5ë¶„ ë§Œì— ì™„ë£Œí•˜ê¸°</div>
    </div>

    <div class="container">
        <!-- 1. Splunk ì„¤ì • -->
        <div class="guide-section">
            <h2 class="section-title">ğŸ¯ 1ë‹¨ê³„: Splunk ì„¤ì •</h2>

            <div class="step-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3 class="step-title">HEC (HTTP Event Collector) í™œì„±í™”</h3>
                    <div class="step-content">
                        Splunk Web UIì—ì„œ ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•œ HECë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
                    </div>

                    <div class="two-column">
                        <div>
                            <h4 style="color: #4CAF50; margin-bottom: 15px;">ğŸ“ ì ‘ì† ê²½ë¡œ</h4>
                            <div class="code-block">
Settings â†’ Data Inputs â†’ HTTP Event Collector â†’ New Token</div>
                        </div>
                        <div class="screenshot-placeholder">
                            Splunk HEC ì„¤ì • í™”ë©´
                        </div>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3 class="step-title">í† í° ìƒì„± ë° ì„¤ì •</h3>
                    <div class="step-content">
                        FortiManager ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•œ ì „ìš© í† í°ì„ ìƒì„±í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
Name: FortiManager-PolicyLookup
Source Type: fortimanager_policy
Index: fortimanager
Enable Indexer Acknowledgment: Yes</div>

                    <div class="warning-box">
                        <strong>âš ï¸ ì£¼ì˜ì‚¬í•­:</strong> ìƒì„±ëœ í† í° ê°’ì€ ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ì„¸ìš”. ì¬í™•ì¸ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3 class="step-title">Index ìƒì„±</h3>
                    <div class="step-content">
                        FortiManager ë°ì´í„°ë¥¼ ì €ì¥í•  ì „ìš© ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# CLI ëª…ë ¹ì–´
./splunk add index fortimanager

# ë˜ëŠ” Web UIì—ì„œ:
# Settings â†’ Indexes â†’ New Index
# Index Name: fortimanager
# Max Size: 10GB (ê¶Œì¥)
# Max Buckets: Hot=10, Warm=20</div>
                </div>

                <div class="step-card">
                    <div class="step-number">4</div>
                    <h3 class="step-title">ëŒ€ì‹œë³´ë“œ XML ì„¤ì¹˜</h3>
                    <div class="step-content">
                        ì œê³µëœ XML ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ì‹œë³´ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
                    </div>

                    <div class="two-column">
                        <div>
                            <h4 style="color: #4CAF50; margin-bottom: 15px;">ğŸ“ ì ‘ì† ê²½ë¡œ</h4>
                            <div class="code-block">
Settings â†’ User Interface â†’ Views â†’ New View â†’ Advanced XML</div>
                        </div>
                        <div>
                            <div class="success-box">
                                <strong>âœ… ì™„ë£Œ í›„:</strong> Apps â†’ Search & Reportingì—ì„œ ëŒ€ì‹œë³´ë“œ í™•ì¸ ê°€ëŠ¥
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. FortiNet ì„¤ì • -->
        <div class="guide-section">
            <h2 class="section-title">ğŸ›¡ï¸ 2ë‹¨ê³„: FortiNet ì„¤ì •</h2>

            <div class="step-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3 class="step-title">FortiManager API í™œì„±í™”</h3>
                    <div class="step-content">
                        Policy Lookup ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ FortiManagerì—ì„œ API ì ‘ê·¼ì„ í™œì„±í™”í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# FortiManager CLIì—ì„œ ì‹¤í–‰
config system admin setting
    set gui-curl-timeout 120
    set gui-polling-interval 10
    set show_add_multiple 1
end

# JSON API í™œì„±í™”
config system global
    set fmg-status enable
end</div>

                    <div class="info-box">
                        <strong>ğŸ“ ì°¸ê³ :</strong> FortiManager 6.0 ì´ìƒì—ì„œ JSON APIê°€ ê¸°ë³¸ ì§€ì›ë©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3 class="step-title">Policy Lookup ì„¤ì •</h3>
                    <div class="step-content">
                        ê° ë°©í™”ë²½ì—ì„œ Policy Lookup ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# FortiGate CLIì—ì„œ ì‹¤í–‰
config system settings
    set gui-policy-lookup enable
end

# ë˜ëŠ” GUIì—ì„œ:
# System â†’ Feature Visibility â†’ Policy Lookup ì²´í¬</div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3 class="step-title">ë¡œê¹… ì„¤ì •</h3>
                    <div class="step-content">
                        ë³´ì•ˆ ì´ë²¤íŠ¸ì™€ íŠ¸ë˜í”½ ë¡œê·¸ë¥¼ FortiManagerë¡œ ì „ì†¡í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
config log fortianalyzer setting
    set status enable
    set server "192.168.1.100"  # FortiManager IP
    set source-ip "192.168.1.10"
    set upload-option realtime
end

config log setting
    set fwpolicy-implicit-log enable
    set local-in-allow enable
    set local-in-deny-broadcast enable
end</div>
                </div>

                <div class="step-card">
                    <div class="step-number">4</div>
                    <h3 class="step-title">ë°ì´í„° ì „ì†¡ ìŠ¤í¬ë¦½íŠ¸</h3>
                    <div class="step-content">
                        FortiManagerì—ì„œ Splunkë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
#!/usr/bin/env python3
import requests
import json
import time

# Splunk HEC ì„¤ì •
SPLUNK_HEC_URL = "https://your-splunk-server:8088/services/collector/event"
SPLUNK_TOKEN = "YOUR_HEC_TOKEN_HERE"

# FortiManager ì„¤ì •
FMG_URL = "https://your-fortimanager:443/jsonrpc"
FMG_USER = "admin"
FMG_PASS = "password"

def send_to_splunk(event_data):
    headers = {
        'Authorization': f'Splunk {SPLUNK_TOKEN}',
        'Content-Type': 'application/json'
    }

    payload = {
        "time": int(time.time()),
        "source": "FortiManager",
        "sourcetype": "fortimanager_policy",
        "event": event_data
    }

    response = requests.post(SPLUNK_HEC_URL,
                           headers=headers,
                           data=json.dumps(payload),
                           verify=False)
    return response.status_code == 200

# ì‚¬ìš© ì˜ˆì‹œ
if __name__ == "__main__":
    sample_event = {
        "device": "PERIMETER-FW-001",
        "src_ip": "192.168.1.100",
        "dst_ip": "10.0.50.200",
        "service": "HTTPS",
        "policy_id": 1842,
        "action": "ALLOW",
        "lookup_time_ms": 45
    }

    if send_to_splunk(sample_event):
        print("âœ… ì´ë²¤íŠ¸ ì „ì†¡ ì„±ê³µ!")
    else:
        print("âŒ ì´ë²¤íŠ¸ ì „ì†¡ ì‹¤íŒ¨!")</div>
                </div>
            </div>
        </div>

        <!-- 3. í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ -->
        <div class="guide-section">
            <h2 class="section-title">âœ… 3ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦</h2>

            <div class="step-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3 class="step-title">ì—°ê²° í…ŒìŠ¤íŠ¸</h3>
                    <div class="step-content">
                        ì„¤ì •ëœ ì—°ë™ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# HEC ì—°ê²° í…ŒìŠ¤íŠ¸
curl -k https://your-splunk-server:8088/services/collector/event \
  -H "Authorization: Splunk YOUR_TOKEN" \
  -d '{"event": {"test": "connection", "timestamp": "'$(date)'"}, "sourcetype": "fortimanager_policy"}'

# ì‘ë‹µ ì˜ˆì‹œ:
# {"text":"Success","code":0}</div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3 class="step-title">ë°ì´í„° í™•ì¸</h3>
                    <div class="step-content">
                        Splunkì—ì„œ ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ì—¬ í™•ì¸í•©ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Splunk Search ëª…ë ¹ì–´
index=fortimanager sourcetype=fortimanager_policy
| head 10
| table _time, device, src_ip, dst_ip, action

# ìµœê·¼ 1ì‹œê°„ Policy Lookup í†µê³„
index=fortimanager sourcetype=policy_lookup
| timechart span=5m count by device_name</div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3 class="step-title">ëŒ€ì‹œë³´ë“œ í™•ì¸</h3>
                    <div class="step-content">
                        ìƒì„±ëœ ëŒ€ì‹œë³´ë“œê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
                    </div>

                    <div class="success-box">
                        <strong>âœ… í™•ì¸ ì‚¬í•­:</strong>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Device Health Status íŒ¨ë„ì— ë°ì´í„° í‘œì‹œ</li>
                            <li>Policy Lookup ì°¨íŠ¸ì— ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</li>
                            <li>Security Events í…Œì´ë¸”ì— ë¡œê·¸ í‘œì‹œ</li>
                            <li>ìƒˆë¡œê³ ì¹¨ ì‹œ ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. ë¬¸ì œ í•´ê²° -->
        <div class="guide-section">
            <h2 class="section-title">ğŸ”§ 4ë‹¨ê³„: ë¬¸ì œ í•´ê²°</h2>

            <div class="step-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3 class="step-title">ë°ì´í„°ê°€ ìˆ˜ì§‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°</h3>
                    <div class="step-content">
                        ê°€ì¥ í”í•œ ë¬¸ì œë“¤ê³¼ í•´ê²° ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# 1. HEC ìƒíƒœ í™•ì¸
./splunk list httpinput

# 2. ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸
./splunk list index

# 3. ë°©í™”ë²½ ê·œì¹™ í™•ì¸ (8088 í¬íŠ¸)
iptables -L | grep 8088

# 4. SSL ì¸ì¦ì„œ ë¬¸ì œ í•´ê²°
curl -k -v https://splunk-server:8088/services/collector/event</div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3 class="step-title">ëŒ€ì‹œë³´ë“œê°€ ë¡œë“œë˜ì§€ ì•ŠëŠ” ê²½ìš°</h3>
                    <div class="step-content">
                        XML êµ¬ë¬¸ ì˜¤ë¥˜ë‚˜ ê¶Œí•œ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.
                    </div>

                    <div class="warning-box">
                        <strong>âš ï¸ ì¼ë°˜ì ì¸ ë¬¸ì œ:</strong>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>XML êµ¬ë¬¸ ì˜¤ë¥˜ (íƒœê·¸ ë¶ˆì¼ì¹˜, íŠ¹ìˆ˜ë¬¸ì)</li>
                            <li>sourcetype ë¶ˆì¼ì¹˜</li>
                            <li>ì¸ë±ìŠ¤ ê¶Œí•œ ë¬¸ì œ</li>
                            <li>ì•± ê¶Œí•œ ì„¤ì •</li>
                        </ul>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3 class="step-title">ì„±ëŠ¥ ìµœì í™”</h3>
                    <div class="step-content">
                        ëŒ€ëŸ‰ì˜ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì„±ëŠ¥ ìµœì í™” ë°©ë²•ì…ë‹ˆë‹¤.
                    </div>

                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# indexes.conf ìµœì í™”
[fortimanager]
maxTotalDataSizeMB = 10000
maxDataSize = auto_high_volume
maxHotBuckets = 10
maxWarmDBCount = 20

# props.conf ì„¤ì •
[fortimanager_policy]
SHOULD_LINEMERGE = false
KV_MODE = json
category = Security
TRUNCATE = 0</div>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <a href="/" class="nav-btn secondary">â† ë©”ì¸ ëŒ€ì‹œë³´ë“œ</a>
            <a href="/xml-demo" class="nav-btn">XML ë³µì‚¬í•˜ê¸° â†’</a>
        </div>
    </div>

    <script>
        function copyCode(button) {
            const codeBlock = button.parentElement;
            const text = codeBlock.textContent.replace('Copy', '').trim();

            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'âœ“ Copied!';
                button.style.background = '#28a745';

                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.style.background = '#238636';
                }, 2000);
            });
        }
    </script>
</body>
</html>